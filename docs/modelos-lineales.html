<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 Modelos lineales | Introducción al Análisis de Datos con R</title>
  <meta name="description" content="Este es un libro introductorio al análisis de datos con R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 Modelos lineales | Introducción al Análisis de Datos con R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este es un libro introductorio al análisis de datos con R" />
  <meta name="github-repo" content="rubenfcasal/intror" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 Modelos lineales | Introducción al Análisis de Datos con R" />
  
  <meta name="twitter:description" content="Este es un libro introductorio al análisis de datos con R" />
  

<meta name="author" content="Rubén Fernández-Casal, Javier Roca-Pardiñas, Julián Costa y Manuel Oviedo" />


<meta name="date" content="2022-05-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelado-de-datos.html"/>
<link rel="next" href="modelos-lineales-generalizados.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introducción al Análisis de Datos con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html#el-lenguaje-y-entorno-estadístico-r"><i class="fa fa-check"></i><b>1.1</b> El lenguaje y entorno estadístico <code>R</code></a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introducción.html"><a href="introducción.html#principales-características"><i class="fa fa-check"></i><b>1.1.1</b> Principales características</a></li>
<li class="chapter" data-level="1.1.2" data-path="introducción.html"><a href="introducción.html#interfaces-gráficas"><i class="fa fa-check"></i><b>1.1.2</b> Interfaces gráficas</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introducción.html"><a href="introducción.html#entorno-de-trabajo"><i class="fa fa-check"></i><b>1.2</b> Entorno de trabajo</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introducción.html"><a href="introducción.html#ventana-de-consola"><i class="fa fa-check"></i><b>1.2.1</b> Ventana de Consola</a></li>
<li class="chapter" data-level="1.2.2" data-path="introducción.html"><a href="introducción.html#ventana-de-script"><i class="fa fa-check"></i><b>1.2.2</b> Ventana de Script</a></li>
<li class="chapter" data-level="1.2.3" data-path="introducción.html"><a href="introducción.html#ayuda-dentro-del-programa"><i class="fa fa-check"></i><b>1.2.3</b> Ayuda dentro del programa</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introducción.html"><a href="introducción.html#librerías"><i class="fa fa-check"></i><b>1.3</b> Librerías</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introducción.html"><a href="introducción.html#paquetes"><i class="fa fa-check"></i><b>1.3.1</b> Paquetes</a></li>
<li class="chapter" data-level="1.3.2" data-path="introducción.html"><a href="introducción.html#instalacion-pkg"><i class="fa fa-check"></i><b>1.3.2</b> Instalación</a></li>
<li class="chapter" data-level="1.3.3" data-path="introducción.html"><a href="introducción.html#carga"><i class="fa fa-check"></i><b>1.3.3</b> Carga</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introducción.html"><a href="introducción.html#una-primera-sesión"><i class="fa fa-check"></i><b>1.4</b> Una primera sesión</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introducción.html"><a href="introducción.html#inicio-de-una-sesión"><i class="fa fa-check"></i><b>1.4.1</b> Inicio de una sesión</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introducción.html"><a href="introducción.html#objetos-básicos"><i class="fa fa-check"></i><b>1.5</b> Objetos básicos</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introducción.html"><a href="introducción.html#objetos-numéricos"><i class="fa fa-check"></i><b>1.5.1</b> Objetos numéricos</a></li>
<li class="chapter" data-level="1.5.2" data-path="introducción.html"><a href="introducción.html#objetos-tipo-carácter"><i class="fa fa-check"></i><b>1.5.2</b> Objetos tipo carácter</a></li>
<li class="chapter" data-level="1.5.3" data-path="introducción.html"><a href="introducción.html#objetos-lógicos"><i class="fa fa-check"></i><b>1.5.3</b> Objetos lógicos</a></li>
<li class="chapter" data-level="1.5.4" data-path="introducción.html"><a href="introducción.html#operadores-lógicos"><i class="fa fa-check"></i><b>1.5.4</b> Operadores lógicos</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introducción.html"><a href="introducción.html#área-de-trabajo"><i class="fa fa-check"></i><b>1.6</b> Área de trabajo</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introducción.html"><a href="introducción.html#guardar-y-cargar-resultados"><i class="fa fa-check"></i><b>1.6.1</b> Guardar y cargar resultados</a></li>
<li class="chapter" data-level="1.6.2" data-path="introducción.html"><a href="introducción.html#directorio-de-trabajo"><i class="fa fa-check"></i><b>1.6.2</b> Directorio de trabajo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html"><i class="fa fa-check"></i><b>2</b> Estructuras de datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#vectores"><i class="fa fa-check"></i><b>2.1</b> Vectores</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#generación-de-secuencias"><i class="fa fa-check"></i><b>2.1.1</b> Generación de secuencias</a></li>
<li class="chapter" data-level="2.1.2" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#generación-secuencias-aleatorias"><i class="fa fa-check"></i><b>2.1.2</b> Generación secuencias aleatorias</a></li>
<li class="chapter" data-level="2.1.3" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#selección-de-elementos-de-un-vector"><i class="fa fa-check"></i><b>2.1.3</b> Selección de elementos de un vector</a></li>
<li class="chapter" data-level="2.1.4" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#ordenación-de-vectores"><i class="fa fa-check"></i><b>2.1.4</b> Ordenación de vectores</a></li>
<li class="chapter" data-level="2.1.5" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#valores-perdidos"><i class="fa fa-check"></i><b>2.1.5</b> Valores perdidos</a></li>
<li class="chapter" data-level="2.1.6" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#vectores-no-numéricos"><i class="fa fa-check"></i><b>2.1.6</b> Vectores no numéricos</a></li>
<li class="chapter" data-level="2.1.7" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#factores"><i class="fa fa-check"></i><b>2.1.7</b> Factores</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#matrices-y-arrays"><i class="fa fa-check"></i><b>2.2</b> Matrices y arrays</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#matrices"><i class="fa fa-check"></i><b>2.2.1</b> Matrices</a></li>
<li class="chapter" data-level="2.2.2" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#nombres-en-matrices"><i class="fa fa-check"></i><b>2.2.2</b> Nombres en matrices</a></li>
<li class="chapter" data-level="2.2.3" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#acceso-a-los-elementos-de-una-matriz"><i class="fa fa-check"></i><b>2.2.3</b> Acceso a los elementos de una matriz</a></li>
<li class="chapter" data-level="2.2.4" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#ordenación-por-filas-y-columnas"><i class="fa fa-check"></i><b>2.2.4</b> Ordenación por filas y columnas</a></li>
<li class="chapter" data-level="2.2.5" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#operaciones-con-matrices-y-arrays"><i class="fa fa-check"></i><b>2.2.5</b> Operaciones con Matrices y Arrays</a></li>
<li class="chapter" data-level="2.2.6" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#ejemplos"><i class="fa fa-check"></i><b>2.2.6</b> Ejemplos</a></li>
<li class="chapter" data-level="2.2.7" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#inversión-de-una-matriz"><i class="fa fa-check"></i><b>2.2.7</b> Inversión de una matriz</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#data-frames"><i class="fa fa-check"></i><b>2.3</b> Data frames</a></li>
<li class="chapter" data-level="2.4" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#listas"><i class="fa fa-check"></i><b>2.4</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gráficos.html"><a href="gráficos.html"><i class="fa fa-check"></i><b>3</b> Gráficos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gráficos.html"><a href="gráficos.html#el-comando-plot"><i class="fa fa-check"></i><b>3.1</b> El comando plot</a></li>
<li class="chapter" data-level="3.2" data-path="gráficos.html"><a href="gráficos.html#funciones-gráficas-de-bajo-nivel"><i class="fa fa-check"></i><b>3.2</b> Funciones gráficas de bajo nivel</a></li>
<li class="chapter" data-level="3.3" data-path="gráficos.html"><a href="gráficos.html#ejemplos-1"><i class="fa fa-check"></i><b>3.3</b> Ejemplos</a></li>
<li class="chapter" data-level="3.4" data-path="gráficos.html"><a href="gráficos.html#parámetros-gráficos"><i class="fa fa-check"></i><b>3.4</b> Parámetros gráficos</a></li>
<li class="chapter" data-level="3.5" data-path="gráficos.html"><a href="gráficos.html#múltiples-gráficos-por-ventana"><i class="fa fa-check"></i><b>3.5</b> Múltiples gráficos por ventana</a></li>
<li class="chapter" data-level="3.6" data-path="gráficos.html"><a href="gráficos.html#exportar-gráficos"><i class="fa fa-check"></i><b>3.6</b> Exportar gráficos</a></li>
<li class="chapter" data-level="3.7" data-path="gráficos.html"><a href="gráficos.html#otras-librerías-gráficas"><i class="fa fa-check"></i><b>3.7</b> Otras librerías gráficas</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="gráficos.html"><a href="gráficos.html#ejemplos-2"><i class="fa fa-check"></i><b>3.7.1</b> Ejemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html"><i class="fa fa-check"></i><b>4</b> Manipulación de datos con R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#lectura-importación-y-exportación-de-datos"><i class="fa fa-check"></i><b>4.1</b> Lectura, importación y exportación de datos</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#formato-de-datos-de-r"><i class="fa fa-check"></i><b>4.1.1</b> Formato de datos de R</a></li>
<li class="chapter" data-level="4.1.2" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#acceso-a-datos-en-paquetes"><i class="fa fa-check"></i><b>4.1.2</b> Acceso a datos en paquetes</a></li>
<li class="chapter" data-level="4.1.3" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#cap4-texto"><i class="fa fa-check"></i><b>4.1.3</b> Lectura de archivos de texto</a></li>
<li class="chapter" data-level="4.1.4" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#alternativa-tidyverse"><i class="fa fa-check"></i><b>4.1.4</b> Alternativa <code>tidyverse</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#importación-desde-spss"><i class="fa fa-check"></i><b>4.1.5</b> Importación desde SPSS</a></li>
<li class="chapter" data-level="4.1.6" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#importación-desde-excel"><i class="fa fa-check"></i><b>4.1.6</b> Importación desde Excel</a></li>
<li class="chapter" data-level="4.1.7" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#exportación-de-datos"><i class="fa fa-check"></i><b>4.1.7</b> Exportación de datos</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#manipulación-de-datos"><i class="fa fa-check"></i><b>4.2</b> Manipulación de datos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#operaciones-con-variables"><i class="fa fa-check"></i><b>4.2.1</b> Operaciones con variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="manipulación-de-datos-con-r.html"><a href="manipulación-de-datos-con-r.html#operaciones-con-casos"><i class="fa fa-check"></i><b>4.2.2</b> Operaciones con casos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>5</b> Análisis exploratorio de datos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#medidas-resumen"><i class="fa fa-check"></i><b>5.1</b> Medidas resumen</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#datos-de-ejemplo"><i class="fa fa-check"></i><b>5.1.1</b> Datos de ejemplo</a></li>
<li class="chapter" data-level="5.1.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#tablas-de-frecuencias"><i class="fa fa-check"></i><b>5.1.2</b> Tablas de frecuencias</a></li>
<li class="chapter" data-level="5.1.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#media-y-varianza"><i class="fa fa-check"></i><b>5.1.3</b> Media y varianza</a></li>
<li class="chapter" data-level="5.1.4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#mediana-y-cuantiles"><i class="fa fa-check"></i><b>5.1.4</b> Mediana y cuantiles</a></li>
<li class="chapter" data-level="5.1.5" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#summary"><i class="fa fa-check"></i><b>5.1.5</b> <em>Summary</em></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#gráficos-1"><i class="fa fa-check"></i><b>5.2</b> Gráficos</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#diagrama-de-barras-y-gráfico-de-sectores"><i class="fa fa-check"></i><b>5.2.1</b> Diagrama de barras y gráfico de sectores</a></li>
<li class="chapter" data-level="5.2.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#gráfico-de-puntos"><i class="fa fa-check"></i><b>5.2.2</b> Gráfico de puntos</a></li>
<li class="chapter" data-level="5.2.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#árbol-de-tallo-y-hojas"><i class="fa fa-check"></i><b>5.2.3</b> Árbol de tallo y hojas</a></li>
<li class="chapter" data-level="5.2.4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#histograma"><i class="fa fa-check"></i><b>5.2.4</b> Histograma</a></li>
<li class="chapter" data-level="5.2.5" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#gráfico-de-densidad"><i class="fa fa-check"></i><b>5.2.5</b> Gráfico de densidad</a></li>
<li class="chapter" data-level="5.2.6" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#diagrama-de-cajas"><i class="fa fa-check"></i><b>5.2.6</b> Diagrama de cajas</a></li>
<li class="chapter" data-level="5.2.7" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#gráfica-de-dispersión"><i class="fa fa-check"></i><b>5.2.7</b> Gráfica de dispersión</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html"><i class="fa fa-check"></i><b>6</b> Inferencia estadística</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#normalidad"><i class="fa fa-check"></i><b>6.1</b> Normalidad</a></li>
<li class="chapter" data-level="6.2" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#contrastes"><i class="fa fa-check"></i><b>6.2</b> Contrastes</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#una-muestra"><i class="fa fa-check"></i><b>6.2.1</b> Una muestra</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#dos-muestras"><i class="fa fa-check"></i><b>6.2.2</b> Dos muestras</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#regresión-y-correlación"><i class="fa fa-check"></i><b>6.3</b> Regresión y correlación</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#regresión-lineal-simple"><i class="fa fa-check"></i><b>6.3.1</b> Regresión lineal simple</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#correlación"><i class="fa fa-check"></i><b>6.3.2</b> Correlación</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#análisis-de-la-varianza"><i class="fa fa-check"></i><b>6.4</b> Análisis de la varianza</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#anova-con-un-factor"><i class="fa fa-check"></i><b>6.4.1</b> ANOVA con un factor</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferencia-estadística.html"><a href="inferencia-estadística.html#test-de-kruskal-wallis"><i class="fa fa-check"></i><b>6.4.2</b> Test de Kruskal-Wallis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelado-de-datos.html"><a href="modelado-de-datos.html"><i class="fa fa-check"></i><b>7</b> Modelado de datos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelado-de-datos.html"><a href="modelado-de-datos.html#modelos-de-regresión"><i class="fa fa-check"></i><b>7.1</b> Modelos de regresión</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modelado-de-datos.html"><a href="modelado-de-datos.html#herramientas-disponibles-en-r"><i class="fa fa-check"></i><b>7.1.1</b> Herramientas disponibles en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelado-de-datos.html"><a href="modelado-de-datos.html#fórmulas"><i class="fa fa-check"></i><b>7.2</b> Fórmulas</a></li>
<li class="chapter" data-level="7.3" data-path="modelado-de-datos.html"><a href="modelado-de-datos.html#ejemplo-regresión-lineal-simple"><i class="fa fa-check"></i><b>7.3</b> Ejemplo: regresión lineal simple</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelos-lineales.html"><a href="modelos-lineales.html"><i class="fa fa-check"></i><b>8</b> Modelos lineales</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ejemplo"><i class="fa fa-check"></i><b>8.1</b> Ejemplo</a></li>
<li class="chapter" data-level="8.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ajuste-función-lm"><i class="fa fa-check"></i><b>8.2</b> Ajuste: función <code>lm</code></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#extracción-de-información"><i class="fa fa-check"></i><b>8.2.1</b> Extracción de información</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#predicción"><i class="fa fa-check"></i><b>8.3</b> Predicción</a></li>
<li class="chapter" data-level="8.4" data-path="modelos-lineales.html"><a href="modelos-lineales.html#selección-de-variables-explicativas"><i class="fa fa-check"></i><b>8.4</b> Selección de variables explicativas</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#búsqueda-exhaustiva"><i class="fa fa-check"></i><b>8.4.1</b> Búsqueda exhaustiva</a></li>
<li class="chapter" data-level="8.4.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#selección-por-pasos"><i class="fa fa-check"></i><b>8.4.2</b> Selección por pasos</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="modelos-lineales.html"><a href="modelos-lineales.html#regresión-con-variables-categóricas"><i class="fa fa-check"></i><b>8.5</b> Regresión con variables categóricas</a></li>
<li class="chapter" data-level="8.6" data-path="modelos-lineales.html"><a href="modelos-lineales.html#interacciones"><i class="fa fa-check"></i><b>8.6</b> Interacciones</a></li>
<li class="chapter" data-level="8.7" data-path="modelos-lineales.html"><a href="modelos-lineales.html#diagnosis-del-modelo"><i class="fa fa-check"></i><b>8.7</b> Diagnosis del modelo</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#gráficas-básicas-de-diagnóstico"><i class="fa fa-check"></i><b>8.7.1</b> Gráficas básicas de diagnóstico</a></li>
<li class="chapter" data-level="8.7.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#gráficos-parciales-de-residuos"><i class="fa fa-check"></i><b>8.7.2</b> Gráficos parciales de residuos</a></li>
<li class="chapter" data-level="8.7.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#estadísticos"><i class="fa fa-check"></i><b>8.7.3</b> Estadísticos</a></li>
<li class="chapter" data-level="8.7.4" data-path="modelos-lineales.html"><a href="modelos-lineales.html#contrastes-1"><i class="fa fa-check"></i><b>8.7.4</b> Contrastes</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="modelos-lineales.html"><a href="modelos-lineales.html#métodos-de-regularización"><i class="fa fa-check"></i><b>8.8</b> Métodos de regularización</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#datos"><i class="fa fa-check"></i><b>8.8.1</b> Datos</a></li>
<li class="chapter" data-level="8.8.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ridge-regression"><i class="fa fa-check"></i><b>8.8.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="8.8.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#lasso"><i class="fa fa-check"></i><b>8.8.3</b> Lasso</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="modelos-lineales.html"><a href="modelos-lineales.html#alternativas"><i class="fa fa-check"></i><b>8.9</b> Alternativas</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#transformación-modelos-linealizables"><i class="fa fa-check"></i><b>8.9.1</b> Transformación (modelos linealizables)</a></li>
<li class="chapter" data-level="8.9.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ajuste-polinómico"><i class="fa fa-check"></i><b>8.9.2</b> Ajuste polinómico</a></li>
<li class="chapter" data-level="8.9.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ajuste-polinómico-local-robusto"><i class="fa fa-check"></i><b>8.9.3</b> Ajuste polinómico local (robusto)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>9</b> Modelos lineales generalizados</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ajuste-función-glm"><i class="fa fa-check"></i><b>9.1</b> Ajuste: función <code>glm</code></a></li>
<li class="chapter" data-level="9.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#regresión-logística"><i class="fa fa-check"></i><b>9.2</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-2"><i class="fa fa-check"></i><b>9.2.1</b> Ejemplo</a></li>
<li class="chapter" data-level="9.2.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ajuste-de-un-modelo-de-regresión-logística"><i class="fa fa-check"></i><b>9.2.2</b> Ajuste de un modelo de regresión logística</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#predicción-1"><i class="fa fa-check"></i><b>9.3</b> Predicción</a></li>
<li class="chapter" data-level="9.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#selección-de-variables-explicativas-1"><i class="fa fa-check"></i><b>9.4</b> Selección de variables explicativas</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#selección-por-pasos-1"><i class="fa fa-check"></i><b>9.4.1</b> Selección por pasos</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#diagnosis-del-modelo-1"><i class="fa fa-check"></i><b>9.5</b> Diagnosis del modelo</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#gráficas-básicas-de-diagnóstico-1"><i class="fa fa-check"></i><b>9.5.1</b> Gráficas básicas de diagnóstico</a></li>
<li class="chapter" data-level="9.5.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#gráficos-parciales-de-residuos-1"><i class="fa fa-check"></i><b>9.5.2</b> Gráficos parciales de residuos</a></li>
<li class="chapter" data-level="9.5.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#estadísticos-1"><i class="fa fa-check"></i><b>9.5.3</b> Estadísticos</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#alternativas-1"><i class="fa fa-check"></i><b>9.6</b> Alternativas</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html"><i class="fa fa-check"></i><b>10</b> Regresión no paramétrica</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html#modelos-aditivos"><i class="fa fa-check"></i><b>10.1</b> Modelos aditivos</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html#ajuste-función-gam"><i class="fa fa-check"></i><b>10.1.1</b> Ajuste: función <code>gam</code></a></li>
<li class="chapter" data-level="10.1.2" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html#ejemplo-3"><i class="fa fa-check"></i><b>10.1.2</b> Ejemplo</a></li>
<li class="chapter" data-level="10.1.3" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html#superficie-de-predicción"><i class="fa fa-check"></i><b>10.1.3</b> Superficie de predicción</a></li>
<li class="chapter" data-level="10.1.4" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html#comparación-de-modelos"><i class="fa fa-check"></i><b>10.1.4</b> Comparación de modelos</a></li>
<li class="chapter" data-level="10.1.5" data-path="regresión-no-paramétrica.html"><a href="regresión-no-paramétrica.html#diagnosis-del-modelo-2"><i class="fa fa-check"></i><b>10.1.5</b> Diagnosis del modelo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="programacion.html"><a href="programacion.html"><i class="fa fa-check"></i><b>11</b> Programación</a>
<ul>
<li class="chapter" data-level="11.1" data-path="programacion.html"><a href="programacion.html#funciones"><i class="fa fa-check"></i><b>11.1</b> Funciones</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="programacion.html"><a href="programacion.html#ejemplo-progresión-geométrica"><i class="fa fa-check"></i><b>11.1.1</b> Ejemplo: progresión geométrica</a></li>
<li class="chapter" data-level="11.1.2" data-path="programacion.html"><a href="programacion.html#argumentos-de-entrada"><i class="fa fa-check"></i><b>11.1.2</b> Argumentos de entrada</a></li>
<li class="chapter" data-level="11.1.3" data-path="programacion.html"><a href="programacion.html#salida"><i class="fa fa-check"></i><b>11.1.3</b> Salida</a></li>
<li class="chapter" data-level="11.1.4" data-path="programacion.html"><a href="programacion.html#otros-ejemplos"><i class="fa fa-check"></i><b>11.1.4</b> Otros ejemplos</a></li>
<li class="chapter" data-level="11.1.5" data-path="programacion.html"><a href="programacion.html#variables-locales-y-globales"><i class="fa fa-check"></i><b>11.1.5</b> Variables locales y globales</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="programacion.html"><a href="programacion.html#ejecución-condicional"><i class="fa fa-check"></i><b>11.2</b> Ejecución condicional</a></li>
<li class="chapter" data-level="11.3" data-path="programacion.html"><a href="programacion.html#bucles-y-vectorización"><i class="fa fa-check"></i><b>11.3</b> Bucles y vectorización</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="programacion.html"><a href="programacion.html#bucles"><i class="fa fa-check"></i><b>11.3.1</b> Bucles</a></li>
<li class="chapter" data-level="11.3.2" data-path="programacion.html"><a href="programacion.html#vectorización"><i class="fa fa-check"></i><b>11.3.2</b> Vectorización</a></li>
<li class="chapter" data-level="11.3.3" data-path="programacion.html"><a href="programacion.html#funciones-apply"><i class="fa fa-check"></i><b>11.3.3</b> Funciones <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="programacion.html"><a href="programacion.html#aplicación-validación-cruzada"><i class="fa fa-check"></i><b>11.4</b> Aplicación: validación cruzada</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="programacion.html"><a href="programacion.html#primer-ejemplo"><i class="fa fa-check"></i><b>11.4.1</b> Primer ejemplo</a></li>
<li class="chapter" data-level="11.4.2" data-path="programacion.html"><a href="programacion.html#segundo-ejemplo"><i class="fa fa-check"></i><b>11.4.2</b> Segundo ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generación-de-informes.html"><a href="generación-de-informes.html"><i class="fa fa-check"></i><b>12</b> Generación de informes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="generación-de-informes.html"><a href="generación-de-informes.html#r-markdown"><i class="fa fa-check"></i><b>12.1</b> R Markdown</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="generación-de-informes.html"><a href="generación-de-informes.html#introducción-1"><i class="fa fa-check"></i><b>12.1.1</b> Introducción</a></li>
<li class="chapter" data-level="12.1.2" data-path="generación-de-informes.html"><a href="generación-de-informes.html#inclusión-de-código-r"><i class="fa fa-check"></i><b>12.1.2</b> Inclusión de código R</a></li>
<li class="chapter" data-level="12.1.3" data-path="generación-de-informes.html"><a href="generación-de-informes.html#inclusión-de-gráficos"><i class="fa fa-check"></i><b>12.1.3</b> Inclusión de gráficos</a></li>
<li class="chapter" data-level="12.1.4" data-path="generación-de-informes.html"><a href="generación-de-informes.html#inclusión-de-tablas"><i class="fa fa-check"></i><b>12.1.4</b> Inclusión de tablas</a></li>
<li class="chapter" data-level="12.1.5" data-path="generación-de-informes.html"><a href="generación-de-informes.html#extracción-del-código-r"><i class="fa fa-check"></i><b>12.1.5</b> Extracción del código R</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="generación-de-informes.html"><a href="generación-de-informes.html#spin"><i class="fa fa-check"></i><b>12.2</b> Spin</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografía-complementaria"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a>
<ul>
<li class="chapter" data-level="A.1" data-path="links.html"><a href="links.html#rstudio-links"><i class="fa fa-check"></i><b>A.1</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="instalacion.html"><a href="instalacion.html"><i class="fa fa-check"></i><b>B</b> Instalación de R</a>
<ul>
<li class="chapter" data-level="B.1" data-path="instalacion.html"><a href="instalacion.html#instalación-de-r-en-windows"><i class="fa fa-check"></i><b>B.1</b> Instalación de R en Windows</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="instalacion.html"><a href="instalacion.html#asistente-de-instalación"><i class="fa fa-check"></i><b>B.1.1</b> Asistente de instalación</a></li>
<li class="chapter" data-level="B.1.2" data-path="instalacion.html"><a href="instalacion.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>B.1.2</b> Instalación de paquetes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="interfaces.html"><a href="interfaces.html"><i class="fa fa-check"></i><b>C</b> Interfaces gráficas</a>
<ul>
<li class="chapter" data-level="C.1" data-path="interfaces.html"><a href="interfaces.html#rstudio"><i class="fa fa-check"></i><b>C.1</b> RStudio</a></li>
<li class="chapter" data-level="C.2" data-path="interfaces.html"><a href="interfaces.html#rcmdr"><i class="fa fa-check"></i><b>C.2</b> RCommander</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="interfaces.html"><a href="interfaces.html#instalación-de-r-commander"><i class="fa fa-check"></i><b>C.2.1</b> Instalación de R-Commander</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html"><i class="fa fa-check"></i><b>D</b> Manipulación de datos con dplyr</a>
<ul>
<li class="chapter" data-level="D.1" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#el-paquete-dplyr"><i class="fa fa-check"></i><b>D.1</b> El paquete <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#datos-de-ejemplo-1"><i class="fa fa-check"></i><b>D.1.1</b> Datos de ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#operaciones-con-variables-columnas"><i class="fa fa-check"></i><b>D.2</b> Operaciones con variables (columnas)</a>
<ul>
<li class="chapter" data-level="D.2.1" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#seleccionar-variables-con-select"><i class="fa fa-check"></i><b>D.2.1</b> Seleccionar variables con <strong>select()</strong></a></li>
<li class="chapter" data-level="D.2.2" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#generar-nuevas-variables-con-mutate"><i class="fa fa-check"></i><b>D.2.2</b> Generar nuevas variables con <strong>mutate()</strong></a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#operaciones-con-casos-filas"><i class="fa fa-check"></i><b>D.3</b> Operaciones con casos (filas)</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#seleccionar-casos-con-filter"><i class="fa fa-check"></i><b>D.3.1</b> Seleccionar casos con <strong>filter()</strong></a></li>
<li class="chapter" data-level="D.3.2" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#organizar-casos-con-arrange"><i class="fa fa-check"></i><b>D.3.2</b> Organizar casos con <strong>arrange()</strong></a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#resumir-valores-con-summarise"><i class="fa fa-check"></i><b>D.4</b> Resumir valores con <strong>summarise()</strong></a></li>
<li class="chapter" data-level="D.5" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#agrupar-casos-con-group_by"><i class="fa fa-check"></i><b>D.5</b> Agrupar casos con <strong>group_by()</strong></a></li>
<li class="chapter" data-level="D.6" data-path="manipulación-de-datos-con-dplyr.html"><a href="manipulación-de-datos-con-dplyr.html#operador-pipe-tubería-redirección"><i class="fa fa-check"></i><b>D.6</b> Operador <em>pipe</em> <strong>%&gt;% </strong>(tubería, redirección)</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="compañías-que-usan-r.html"><a href="compañías-que-usan-r.html"><i class="fa fa-check"></i><b>E</b> Compañías que usan <code>R</code></a>
<ul>
<li class="chapter" data-level="E.1" data-path="compañías-que-usan-r.html"><a href="compañías-que-usan-r.html#microsoft"><i class="fa fa-check"></i><b>E.1</b> Microsoft</a></li>
<li class="chapter" data-level="E.2" data-path="compañías-que-usan-r.html"><a href="compañías-que-usan-r.html#rstudio-com"><i class="fa fa-check"></i><b>E.2</b> RStudio</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción al Análisis de Datos con <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-lineales" class="section level1" number="8">
<h1><span class="header-section-number">Capítulo 8</span> Modelos lineales</h1>
<p>Suponen que la función de regresión es lineal:</p>
<p><span class="math display">\[Y=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{p}X_{p}+\varepsilon\]</span></p>
<p>El efecto de las variables explicativas sobre la respuesta es simple (proporcional a su valor).</p>
<div id="ejemplo" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Ejemplo</h2>
<p>El fichero <em>hatco.RData</em> contiene observaciones de clientes de la compañía de
distribución industrial (Compañía Hair, Anderson y Tatham).
Las variables se pueden clasificar en tres grupos:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="modelos-lineales.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;datos/hatco.RData&#39;</span>)</span>
<span id="cb539-2"><a href="modelos-lineales.html#cb539-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">attr</span>(hatco, <span class="st">&quot;variable.labels&quot;</span>))</span></code></pre></div>
<pre><code>##          attr(hatco, &quot;variable.labels&quot;)
## empresa                         Empresa
## tamano             Tamaño de la empresa
## adquisic      Estructura de adquisición
## tindustr              Tipo de industria
## tsitcomp    Tipo de situación de compra
## velocida           Velocidad de entrega
## precio                 Nivel de precios
## flexprec        Flexibilidad de precios
## imgfabri          Imagen del fabricante
## servconj              Servicio conjunto
## imgfvent     Imagen de fuerza de ventas
## calidadp            Calidad de producto
## fidelida   Porcentaje de compra a HATCO
## satisfac            Satisfacción global
## nfidelid        Nivel de compra a HATCO
## nsatisfa          Nivel de satisfacción</code></pre>
<p>Consideraremos como respuesta la variable <em>fidelida</em> y como variables explicativas
el resto de variables continuas menos <em>satisfac</em>.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="modelos-lineales.html#cb541-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> hatco[, <span class="dv">6</span><span class="sc">:</span><span class="dv">13</span>]  <span class="co"># Nota: realmente no copia el objeto...</span></span>
<span id="cb541-2"><a href="modelos-lineales.html#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="modelos-lineales.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cor(datos, use = &quot;complete&quot;) # Por defecto 8 decimales...</span></span>
<span id="cb542-2"><a href="modelos-lineales.html#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cor</span>(datos, <span class="at">use =</span> <span class="st">&quot;complete&quot;</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##          velocida precio flexprec imgfabri servconj imgfvent calidadp fidelida
## velocida    1.000 -0.354    0.519    0.049    0.609    0.081   -0.490    0.674
## precio     -0.354  1.000   -0.486    0.272    0.511    0.189    0.468    0.077
## flexprec    0.519 -0.486    1.000   -0.115    0.075   -0.038   -0.445    0.578
## imgfabri    0.049  0.272   -0.115    1.000    0.298    0.790    0.199    0.224
## servconj    0.609  0.511    0.075    0.298    1.000    0.246   -0.062    0.698
## imgfvent    0.081  0.189   -0.038    0.790    0.246    1.000    0.181    0.267
## calidadp   -0.490  0.468   -0.445    0.199   -0.062    0.181    1.000   -0.204
## fidelida    0.674  0.077    0.578    0.224    0.698    0.267   -0.204    1.000</code></pre>
</div>
<div id="ajuste-función-lm" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Ajuste: función <code>lm</code></h2>
<p>Para el ajuste (estimación de los parámetros) de un modelo lineal a un conjunto de datos (por mínimos cuadrados) se emplea la función <code>lm</code>:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="modelos-lineales.html#cb544-1" aria-hidden="true" tabindex="-1"></a>ajuste <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, datos, seleccion, pesos, na.action)</span></code></pre></div>
<ul>
<li><code>formula</code> fórmula que especifica el modelo.</li>
<li><code>datos</code> data.frame opcional con las variables de la formula.</li>
<li><code>seleccion</code> especificación opcional de un subconjunto de observaciones.</li>
<li><code>pesos</code> vector opcional de pesos (WLS).</li>
<li><code>na.action</code> opción para manejar los datos faltantes (<code>na.omit</code>).</li>
</ul>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="modelos-lineales.html#cb545-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(fidelida <span class="sc">~</span> servconj, datos)</span>
<span id="cb545-2"><a href="modelos-lineales.html#cb545-2" aria-hidden="true" tabindex="-1"></a>modelo</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ servconj, data = datos)
## 
## Coefficients:
## (Intercept)     servconj  
##       21.98         8.30</code></pre>
<p>Al imprimir el ajuste resultante se muestra un pequeño resumen del ajuste (aunque el objeto que contiene los resultados es una lista).</p>
<p>Para obtener un resumen más completo se puede utilizar la función <code>summary()</code>.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="modelos-lineales.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ servconj, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.1956  -4.0655   0.2944   4.5945  11.9744 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  21.9754     2.6086   8.424 3.34e-13 ***
## servconj      8.3000     0.8645   9.601 9.76e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.432 on 97 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.4872, Adjusted R-squared:  0.482 
## F-statistic: 92.17 on 1 and 97 DF,  p-value: 9.765e-16</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="modelos-lineales.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fidelida <span class="sc">~</span> servconj, datos)</span>
<span id="cb549-2"><a href="modelos-lineales.html#cb549-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(modelo)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div id="extracción-de-información" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Extracción de información</h3>
<p>Para la extracción de información se pueden acceder a los componentes del modelo ajustado o emplear funciones (genéricas). Algunas de las más utilizadas son las siguientes:</p>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th>Función</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fitted</code></td>
<td>valores ajustados</td>
</tr>
<tr class="even">
<td><code>coef</code></td>
<td>coeficientes estimados (y errores estándar)</td>
</tr>
<tr class="odd">
<td><code>confint</code></td>
<td>intervalos de confianza para los coeficientes</td>
</tr>
<tr class="even">
<td><code>residuals</code></td>
<td>residuos</td>
</tr>
<tr class="odd">
<td><code>plot</code></td>
<td>gráficos de diagnóstico</td>
</tr>
<tr class="even">
<td><code>termplot</code></td>
<td>gráfico de efectos parciales</td>
</tr>
<tr class="odd">
<td><code>anova</code></td>
<td>calcula tablas de análisis de varianza (también permite comparar modelos)</td>
</tr>
<tr class="even">
<td><code>predict</code></td>
<td>calcula predicciones para nuevos datos</td>
</tr>
</tbody>
</table>
<p>Ejemplo:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="modelos-lineales.html#cb550-1" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fidelida <span class="sc">~</span> servconj <span class="sc">+</span> flexprec, <span class="at">data =</span> hatco)</span>
<span id="cb550-2"><a href="modelos-lineales.html#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ servconj + flexprec, data = hatco)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.2549  -2.2850   0.3411   3.3260   7.0853 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.4617     2.9734  -1.164    0.247    
## servconj      7.8287     0.5897  13.276   &lt;2e-16 ***
## flexprec      3.4017     0.3191  10.661   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.375 on 96 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.7652, Adjusted R-squared:  0.7603 
## F-statistic: 156.4 on 2 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="modelos-lineales.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(modelo2)</span></code></pre></div>
<pre><code>##                 2.5 %   97.5 %
## (Intercept) -9.363813 2.440344
## servconj     6.658219 8.999274
## flexprec     2.768333 4.035030</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="modelos-lineales.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: fidelida
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## servconj   1 3813.6  3813.6  199.23 &lt; 2.2e-16 ***
## flexprec   1 2175.6  2175.6  113.66 &lt; 2.2e-16 ***
## Residuals 96 1837.6    19.1                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="modelos-lineales.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(modelo2, modelo)</span></span>
<span id="cb556-2"><a href="modelos-lineales.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="co"># termplot(modelo2, partial.resid = TRUE)</span></span></code></pre></div>
<p>Muchas de estas funciones genéricas son válidas para otros tipos de
modelos (glm, …).</p>
<p>Algunas funciones como <code>summary()</code> devuelven información adicional:</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="modelos-lineales.html#cb557-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo2)</span>
<span id="cb557-2"><a href="modelos-lineales.html#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res)</span></code></pre></div>
<pre><code>##  [1] &quot;call&quot;          &quot;terms&quot;         &quot;residuals&quot;     &quot;coefficients&quot; 
##  [5] &quot;aliased&quot;       &quot;sigma&quot;         &quot;df&quot;            &quot;r.squared&quot;    
##  [9] &quot;adj.r.squared&quot; &quot;fstatistic&quot;    &quot;cov.unscaled&quot;  &quot;na.action&quot;</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="modelos-lineales.html#cb559-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 4.375074</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="modelos-lineales.html#cb561-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.7603292</code></pre>
</div>
</div>
<div id="predicción" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Predicción</h2>
<p>Para calcular predicciones (estimaciones de la media condicionada) se puede emplear la función <code>predict()</code> (ejecutar <code>help(predict.lm)</code> para ver todas las opciones disponibles).
Por defecto obtiene las predicciones correspondientes a las observaciones (<code>modelo$fitted.values</code>). Para otros casos hay que emplear el argumento <code>newdata</code>:</p>
<ul>
<li>data.frame con los valores de (todas) las covariables, sus nombres
deben coincidir con los originales.</li>
</ul>
<p>Ejemplo:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="modelos-lineales.html#cb563-1" aria-hidden="true" tabindex="-1"></a>valores <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb563-2"><a href="modelos-lineales.html#cb563-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">servconj =</span> valores))</span>
<span id="cb563-3"><a href="modelos-lineales.html#cb563-3" aria-hidden="true" tabindex="-1"></a>pred</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 21.97544 30.27548 38.57552 46.87556 55.17560 63.47564</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="modelos-lineales.html#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fidelida <span class="sc">~</span> servconj, datos)</span>
<span id="cb565-2"><a href="modelos-lineales.html#cb565-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(valores, pred)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Esta función también permite obtener intervalos de confianza y de predicción:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="modelos-lineales.html#cb566-1" aria-hidden="true" tabindex="-1"></a>valores <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">len =</span> <span class="dv">100</span>)</span>
<span id="cb566-2"><a href="modelos-lineales.html#cb566-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">servconj =</span> valores)</span>
<span id="cb566-3"><a href="modelos-lineales.html#cb566-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> newdata, <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb566-4"><a href="modelos-lineales.html#cb566-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 21.97544 16.79816 27.15272
## 2 22.39463 17.30126 27.48800
## 3 22.81383 17.80427 27.82338
## 4 23.23302 18.30718 28.15886
## 5 23.65221 18.80999 28.49444
## 6 24.07141 19.31269 28.83013</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="modelos-lineales.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fidelida <span class="sc">~</span> servconj, datos)</span>
<span id="cb568-2"><a href="modelos-lineales.html#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(valores, pred, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb568-3"><a href="modelos-lineales.html#cb568-3" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> newdata, <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">&quot;prediction&quot;</span>))</span>
<span id="cb568-4"><a href="modelos-lineales.html#cb568-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(valores, pred2[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb568-5"><a href="modelos-lineales.html#cb568-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Ajuste&quot;</span>, <span class="st">&quot;Int. confianza&quot;</span>, <span class="st">&quot;Int. predicción&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="selección-de-variables-explicativas" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Selección de variables explicativas</h2>
<p>Cuando se dispone de un conjunto grande de posibles variables explicativas
suele ser especialmente importante determinar cuales de estas deberían ser
incluidas en el modelo de regresión.
Si alguna de las variables no contiene información relevante sobre la respuesta
no se debería incluir (se simplificaría la interpretación del modelo, aumentaría
la precisión de la estimación y se evitarían problemas como la multicolinealidad).
Se trataría entonces de conseguir un buen ajuste con el menor número de variables explicativas posible.</p>
<p>Para actualizar un modelo (p.e. eliminando o añadiendo variables) se puede emplear la función <code>update</code>:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="modelos-lineales.html#cb569-1" aria-hidden="true" tabindex="-1"></a>modelo.completo <span class="ot">&lt;-</span> <span class="fu">lm</span>(fidelida <span class="sc">~</span> . , <span class="at">data =</span> datos)</span>
<span id="cb569-2"><a href="modelos-lineales.html#cb569-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo.completo)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ ., data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.3351  -2.0733   0.5224   2.9218   6.7106 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -9.5935     4.8213  -1.990   0.0496 *  
## velocida     -0.6023     1.9590  -0.307   0.7592    
## precio       -1.0771     2.0283  -0.531   0.5967    
## flexprec      3.4616     0.3997   8.660 1.62e-13 ***
## imgfabri     -0.1735     0.6472  -0.268   0.7892    
## servconj      9.0919     3.8023   2.391   0.0189 *  
## imgfvent      1.5596     0.9221   1.691   0.0942 .  
## calidadp      0.4874     0.3451   1.412   0.1613    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.281 on 91 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.7869, Adjusted R-squared:  0.7705 
## F-statistic:    48 on 7 and 91 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="modelos-lineales.html#cb571-1" aria-hidden="true" tabindex="-1"></a>modelo.reducido <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo.completo, . <span class="sc">~</span> . <span class="sc">-</span> imgfabri)</span>
<span id="cb571-2"><a href="modelos-lineales.html#cb571-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo.reducido)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ velocida + precio + flexprec + servconj + 
##     imgfvent + calidadp, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.2195  -2.0022   0.4724   2.9514   6.8328 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -9.9900     4.5656  -2.188   0.0312 *  
## velocida     -0.5207     1.9254  -0.270   0.7874    
## precio       -1.0017     1.9986  -0.501   0.6174    
## flexprec      3.4709     0.3962   8.761 9.23e-14 ***
## servconj      8.9111     3.7230   2.394   0.0187 *  
## imgfvent      1.3699     0.5883   2.329   0.0221 *  
## calidadp      0.4844     0.3432   1.411   0.1615    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.26 on 92 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.7867, Adjusted R-squared:  0.7728 
## F-statistic: 56.56 on 6 and 92 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Para obtener el modelo “óptimo” lo ideal sería evaluar todos los modelos posibles.</p>
<div id="búsqueda-exhaustiva" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Búsqueda exhaustiva</h3>
<p>La función <code>regsubsets</code> del paquete <code>leaps</code> permite seleccionar los mejores modelos
fijando el número de variables explicativas.
Por defecto, evalúa todos los modelos posibles con un determinado número de
parámetros (variando desde 1 hasta un máximo de <code>nvmax=8</code>)
y selecciona el mejor (<code>nbest=1</code>).</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="modelos-lineales.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span></code></pre></div>
<pre><code>## Warning: package &#39;leaps&#39; was built under R version 4.1.1</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="modelos-lineales.html#cb575-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(fidelida <span class="sc">~</span> . , <span class="at">data =</span> datos)</span>
<span id="cb575-2"><a href="modelos-lineales.html#cb575-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(fidelida ~ ., data = datos)
## 7 Variables  (and intercept)
##          Forced in Forced out
## velocida     FALSE      FALSE
## precio       FALSE      FALSE
## flexprec     FALSE      FALSE
## imgfabri     FALSE      FALSE
## servconj     FALSE      FALSE
## imgfvent     FALSE      FALSE
## calidadp     FALSE      FALSE
## 1 subsets of each size up to 7
## Selection Algorithm: exhaustive
##          velocida precio flexprec imgfabri servconj imgfvent calidadp
## 1  ( 1 ) &quot; &quot;      &quot; &quot;    &quot; &quot;      &quot; &quot;      &quot;*&quot;      &quot; &quot;      &quot; &quot;     
## 2  ( 1 ) &quot; &quot;      &quot; &quot;    &quot;*&quot;      &quot; &quot;      &quot;*&quot;      &quot; &quot;      &quot; &quot;     
## 3  ( 1 ) &quot; &quot;      &quot; &quot;    &quot;*&quot;      &quot; &quot;      &quot;*&quot;      &quot;*&quot;      &quot; &quot;     
## 4  ( 1 ) &quot; &quot;      &quot; &quot;    &quot;*&quot;      &quot; &quot;      &quot;*&quot;      &quot;*&quot;      &quot;*&quot;     
## 5  ( 1 ) &quot; &quot;      &quot;*&quot;    &quot;*&quot;      &quot; &quot;      &quot;*&quot;      &quot;*&quot;      &quot;*&quot;     
## 6  ( 1 ) &quot;*&quot;      &quot;*&quot;    &quot;*&quot;      &quot; &quot;      &quot;*&quot;      &quot;*&quot;      &quot;*&quot;     
## 7  ( 1 ) &quot;*&quot;      &quot;*&quot;    &quot;*&quot;      &quot;*&quot;      &quot;*&quot;      &quot;*&quot;      &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="modelos-lineales.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># names(summary(res))</span></span></code></pre></div>
<p>Al representar el resultado se obtiene un gráfico con los mejores modelos ordenados
según el criterio determinado por el argumento <code>scale = c("bic", "Cp", "adjr2", "r2")</code>.
Por ejemplo, en este caso, empleando el coeficiente de determinación ajustado, obtendríamos:</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="modelos-lineales.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res, <span class="at">scale =</span> <span class="st">&quot;adjr2&quot;</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>En este caso (considerando que una mejora del 2% no es significativa), el modelo resultante sería:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="modelos-lineales.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(fidelida <span class="sc">~</span> servconj <span class="sc">+</span> flexprec, <span class="at">data =</span> hatco)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ servconj + flexprec, data = hatco)
## 
## Coefficients:
## (Intercept)     servconj     flexprec  
##      -3.462        7.829        3.402</code></pre>
<p><strong>Notas</strong>:</p>
<ul>
<li><p>Si se emplea alguno de los criterios habituales, el mejor modelo con un determinado
número de variables no depende del criterio empleado.
Pero estos criterios pueden diferir al comparar modelos con distinto número de
variables explicativas.</p></li>
<li><p>Si el número de variables explicativas es grande, en lugar de emplear una
búsqueda exhaustiva se puede emplear un criterio por pasos, mediante el argumento
<code>method = c("backward", "forward", "seqrep")</code>, pero puede ser recomendable
emplear el paquete <code>MASS</code> para obtener directamente el modelo final.</p></li>
</ul>
</div>
<div id="selección-por-pasos" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Selección por pasos</h3>
<p>Si el número de variables es grande (no sería práctico evaluar todas las posibilidades)
se suele utilizar alguno (o varios) de los siguientes métodos:</p>
<ul>
<li><p><strong>Selección progresiva</strong> (forward): Se parte de una situación en la
que no hay ninguna variable y en cada paso se incluye una aplicando
un <strong>criterio de entrada</strong> (hasta que ninguna de las restantes lo
verifican).</p></li>
<li><p><strong>Eliminación progresiva</strong> (backward): Se parte del modelo con todas
las variables y en cada paso se elimina una aplicando un <strong>criterio
de salida</strong> (hasta que ninguna de las incluidas lo verifican).</p></li>
<li><p><strong>Regresión paso a paso</strong> (stepwise): El más utilizado, se combina
un criterio de entrada y uno de salida. Normalmente se parte sin
ninguna variable y <strong>en cada paso puede haber una inclusión y una
exclusión</strong> (forward/backward).</p></li>
</ul>
<p>La función <code>stepAIC</code> del paquete <code>MASS</code> permite seleccionar el modelo por pasos,
hacia delante o hacia atrás según criterio AIC o BIC (también esta disponible una función <code>step</code> del paquete base <code>stats</code> con menos opciones).
La función <code>stepwise</code> del paquete <code>RcmdrMisc</code> es una interfaz de <code>stepAIC</code>
que facilita su uso:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="modelos-lineales.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb581-2"><a href="modelos-lineales.html#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RcmdrMisc)</span></code></pre></div>
<pre><code>## Warning: package &#39;RcmdrMisc&#39; was built under R version 4.1.1</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="modelos-lineales.html#cb583-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">stepwise</span>(modelo.completo, <span class="at">direction =</span> <span class="st">&quot;forward/backward&quot;</span>, <span class="at">criterion =</span> <span class="st">&quot;BIC&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Direction:  forward/backward
## Criterion:  BIC 
## 
## Start:  AIC=437.24
## fidelida ~ 1
## 
##            Df Sum of Sq    RSS    AIC
## + servconj  1    3813.6 4013.2 375.71
## + velocida  1    3558.5 4268.2 381.81
## + flexprec  1    2615.5 5211.3 401.57
## + imgfvent  1     556.9 7269.9 434.53
## + imgfabri  1     394.2 7432.5 436.72
## &lt;none&gt;                  7826.8 437.24
## + calidadp  1     325.8 7501.0 437.63
## + precio    1      46.2 7780.6 441.25
## 
## Step:  AIC=375.71
## fidelida ~ servconj
## 
##            Df Sum of Sq    RSS    AIC
## + flexprec  1    2175.6 1837.6 302.97
## + precio    1     831.5 3181.7 357.32
## + velocida  1     772.3 3240.9 359.15
## + calidadp  1     203.8 3809.4 375.15
## &lt;none&gt;                  4013.2 375.71
## + imgfvent  1      74.8 3938.4 378.44
## + imgfabri  1       2.3 4010.9 380.25
## - servconj  1    3813.6 7826.8 437.24
## 
## Step:  AIC=302.97
## fidelida ~ servconj + flexprec
## 
##            Df Sum of Sq    RSS    AIC
## + imgfvent  1     129.8 1707.7 300.31
## &lt;none&gt;                  1837.6 302.97
## + imgfabri  1      69.3 1768.3 303.76
## + calidadp  1      50.7 1786.9 304.80
## + precio    1       0.2 1837.4 307.56
## + velocida  1       0.0 1837.5 307.57
## - flexprec  1    2175.6 4013.2 375.71
## - servconj  1    3373.7 5211.3 401.57
## 
## Step:  AIC=300.31
## fidelida ~ servconj + flexprec + imgfvent
## 
##            Df Sum of Sq    RSS    AIC
## &lt;none&gt;                  1707.7 300.31
## - imgfvent  1    129.82 1837.6 302.97
## + calidadp  1     24.70 1683.0 303.47
## + precio    1      0.96 1706.8 304.85
## + imgfabri  1      0.66 1707.1 304.87
## + velocida  1      0.41 1707.3 304.88
## - flexprec  1   2230.67 3938.4 378.44
## - servconj  1   2850.14 4557.9 392.91</code></pre>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="modelos-lineales.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fidelida ~ servconj + flexprec + imgfvent, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.9301  -2.1395   0.0695   2.9632   7.4286 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -6.7761     3.1343  -2.162   0.0331 *  
## servconj      7.4320     0.5902  12.592   &lt;2e-16 ***
## flexprec      3.4503     0.3097  11.140   &lt;2e-16 ***
## imgfvent      1.5369     0.5719   2.687   0.0085 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.24 on 95 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.7818, Adjusted R-squared:  0.7749 
## F-statistic: 113.5 on 3 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Los métodos disponibles son <code>"backward/forward"</code>, <code>"forward/backward"</code>, <code>"backward"</code> y <code>"forward"</code>.</p>
<p>Cuando el número de variables explicativas es muy grande (o si el tamaño de la muestra es pequeño en comparación) pueden aparecer problemas al emplear los métodos anteriores (incluso pueden no ser aplicables). Una alternativa son los métodos de regularización (Ridge regression, Lasso) disponibles en el paquete <code>glmnet</code>.</p>
</div>
</div>
<div id="regresión-con-variables-categóricas" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Regresión con variables categóricas</h2>
<p>La función <code>lm()</code> admite también variables categóricas (factores), lo que equivaldría a modelos de análisis de la varianza o de la covarianza.</p>
<p>Como ejemplo, en el resto del tema emplearemos los datos de empleados:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="modelos-lineales.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datos/empleados.RData&quot;</span>)</span>
<span id="cb587-2"><a href="modelos-lineales.html#cb587-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">with</span>(empleados, <span class="fu">data.frame</span>(<span class="at">lnsal =</span> <span class="fu">log</span>(salario), <span class="at">lnsalini =</span> <span class="fu">log</span>(salini), catlab, sexo))</span></code></pre></div>
<p>Al incluir variables categóricas la función <code>lm()</code> genera las variables indicadoras (variables dummy) que sean necesarias.
Por ejemplo, la función <code>model.matrix()</code> construye la denominada matriz de diseño <span class="math inline">\(X\)</span> de un modelo lineal:
<span class="math display">\[\mathbf{Y}=X\mathbf{\beta}+\mathbf{\varepsilon}\]</span>
En el caso de una variable categórica, por defecto se toma la primera categoría como referencia y se generan variables indicadoras del resto de categorías:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="modelos-lineales.html#cb588-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lnsal <span class="sc">~</span> catlab, datos)</span>
<span id="cb588-2"><a href="modelos-lineales.html#cb588-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<pre><code>##   (Intercept) catlabSeguridad catlabDirectivo
## 1           1               0               1
## 2           1               0               0
## 3           1               0               0
## 4           1               0               0
## 5           1               0               0
## 6           1               0               0</code></pre>
<p>En el correspondiente ajuste (análisis de la varianza de un factor):</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="modelos-lineales.html#cb590-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnsal <span class="sc">~</span> catlab, datos)</span>
<span id="cb590-2"><a href="modelos-lineales.html#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lnsal ~ catlab, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.58352 -0.15983 -0.01012  0.13277  1.08725 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     10.20254    0.01280 797.245  &lt; 2e-16 ***
## catlabSeguridad  0.13492    0.04864   2.774  0.00576 ** 
## catlabDirectivo  0.82709    0.02952  28.017  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2438 on 471 degrees of freedom
## Multiple R-squared:  0.625,  Adjusted R-squared:  0.6234 
## F-statistic: 392.6 on 2 and 471 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>el nivel de referencia no tiene asociado un coeficiente (su efecto se corresponde con <code>(Intercept)</code>). Los coeficientes del resto de niveles miden el cambio que se produce en la media al cambiar desde la categoría de referencia (diferencias de efectos respecto al nivel de referencia).</p>
<p>Para contrastar el efecto de los factores, es preferible emplear la función <code>anova</code>:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="modelos-lineales.html#cb592-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnsal <span class="sc">~</span> catlab <span class="sc">+</span> sexo, datos)</span>
<span id="cb592-2"><a href="modelos-lineales.html#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: lnsal
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## catlab      2 46.674 23.3372  489.59 &lt; 2.2e-16 ***
## sexo        1  5.596  5.5965  117.41 &lt; 2.2e-16 ***
## Residuals 470 22.404  0.0477                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Notas</strong>:</p>
<ul>
<li><p>Para centrarse en las efectos de los factores, se puede emplear la función
<code>aov</code> (analysis of variance; ver también <code>model.tables()</code> y <code>TukeyHSD()</code>). Esta
función llama internamente a <code>lm()</code> (utilizando la misma parametrización).</p></li>
<li><p>Para utilizar distintas parametrizaciones de los efectos se puede emplear
el argumento <code>contrasts = c("contr.treatment", "contr.poly")</code>
(ver <code>help(contrasts)</code>).</p></li>
</ul>
</div>
<div id="interacciones" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Interacciones</h2>
<p>Al emplear el operador <code>+</code> se considera que los efectos de las covariables son aditivos (independientes):</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="modelos-lineales.html#cb594-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnsal <span class="sc">~</span> lnsalini <span class="sc">+</span> catlab, datos)</span>
<span id="cb594-2"><a href="modelos-lineales.html#cb594-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: lnsal
##            Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
## lnsalini    1 58.668  58.668 1901.993 &lt; 2.2e-16 ***
## catlab      2  1.509   0.755   24.465 7.808e-11 ***
## Residuals 470 14.497   0.031                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="modelos-lineales.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lnsal <span class="sc">~</span> lnsalini, <span class="at">data =</span> datos, <span class="at">pch =</span> <span class="fu">as.numeric</span>(catlab), <span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>)</span>
<span id="cb596-2"><a href="modelos-lineales.html#cb596-2" aria-hidden="true" tabindex="-1"></a>parest <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)</span>
<span id="cb596-3"><a href="modelos-lineales.html#cb596-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parest[<span class="dv">1</span>], <span class="at">b =</span> parest[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb596-4"><a href="modelos-lineales.html#cb596-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parest[<span class="dv">1</span>] <span class="sc">+</span> parest[<span class="dv">3</span>], <span class="at">b =</span> parest[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb596-5"><a href="modelos-lineales.html#cb596-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parest[<span class="dv">1</span>] <span class="sc">+</span> parest[<span class="dv">4</span>], <span class="at">b =</span> parest[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb596-6"><a href="modelos-lineales.html#cb596-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">levels</span>(datos<span class="sc">$</span>catlab), <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Para especificar que el efecto de una covariable depende de otra (interacción),
se pueden emplear los operadores <code>*</code> ó <code>:</code>.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="modelos-lineales.html#cb597-1" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnsal <span class="sc">~</span> lnsalini<span class="sc">*</span>catlab, datos)</span>
<span id="cb597-2"><a href="modelos-lineales.html#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lnsal ~ lnsalini * catlab, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.37440 -0.11335 -0.00524  0.10459  0.97018 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               1.66865    0.43820   3.808 0.000159 ***
## lnsalini                  0.89512    0.04595  19.479  &lt; 2e-16 ***
## catlabSeguridad           8.31808    3.01827   2.756 0.006081 ** 
## catlabDirectivo           3.01268    0.79509   3.789 0.000171 ***
## lnsalini:catlabSeguridad -0.85864    0.31392  -2.735 0.006470 ** 
## lnsalini:catlabDirectivo -0.27713    0.07924  -3.497 0.000515 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1727 on 468 degrees of freedom
## Multiple R-squared:  0.8131, Adjusted R-squared:  0.8111 
## F-statistic: 407.3 on 5 and 468 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="modelos-lineales.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: lnsal
##                  Df Sum Sq Mean Sq   F value    Pr(&gt;F)    
## lnsalini          1 58.668  58.668 1967.6294 &lt; 2.2e-16 ***
## catlab            2  1.509   0.755   25.3090 3.658e-11 ***
## lnsalini:catlab   2  0.543   0.272    9.1097 0.0001315 ***
## Residuals       468 13.954   0.030                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>En este caso las pendientes también varían dependiendo del nivel del factor:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="modelos-lineales.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lnsal <span class="sc">~</span> lnsalini, <span class="at">data =</span> datos, <span class="at">pch =</span> <span class="fu">as.numeric</span>(catlab), <span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>)</span>
<span id="cb601-2"><a href="modelos-lineales.html#cb601-2" aria-hidden="true" tabindex="-1"></a>parest <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo2)</span>
<span id="cb601-3"><a href="modelos-lineales.html#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parest[<span class="dv">1</span>], <span class="at">b =</span> parest[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb601-4"><a href="modelos-lineales.html#cb601-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parest[<span class="dv">1</span>] <span class="sc">+</span> parest[<span class="dv">3</span>], <span class="at">b =</span> parest[<span class="dv">2</span>] <span class="sc">+</span> parest[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb601-5"><a href="modelos-lineales.html#cb601-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> parest[<span class="dv">1</span>] <span class="sc">+</span> parest[<span class="dv">4</span>], <span class="at">b =</span> parest[<span class="dv">2</span>] <span class="sc">+</span> parest[<span class="dv">6</span>], <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb601-6"><a href="modelos-lineales.html#cb601-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">levels</span>(datos<span class="sc">$</span>catlab), <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Por ejemplo, empleando la fórmula <code>lnsal ~ lnsalini:catlab</code> se considerarían distintas pendientes pero el mismo término independiente.</p>
</div>
<div id="diagnosis-del-modelo" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Diagnosis del modelo</h2>
<p>Las conclusiones obtenidas con este método se basan en las hipótesis básicas del modelo:</p>
<ul>
<li><p>Linealidad.</p></li>
<li><p>Normalidad (y homogeneidad).</p></li>
<li><p>Homocedasticidad.</p></li>
<li><p>Independencia.</p></li>
<li><p>Ninguna de las variables explicativas es combinación lineal de
las demás.</p></li>
</ul>
<p>Si alguna de estas hipótesis no es cierta, las conclusiones obtenidas pueden no ser
fiables, o incluso totalmente erróneas. En el caso de regresión múltiple es
de especial interés el fenómeno de la multicolinealidad (o colinearidad)
relacionado con la última de estas hipótesis.</p>
<p>En esta sección consideraremos como ejemplo el modelo:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="modelos-lineales.html#cb602-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(salario <span class="sc">~</span> salini <span class="sc">+</span> expprev, <span class="at">data =</span> empleados)</span>
<span id="cb602-2"><a href="modelos-lineales.html#cb602-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)   </span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = salario ~ salini + expprev, data = empleados)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -32263  -4219  -1332   2673  48571 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 3850.71760  900.63287   4.276 2.31e-05 ***
## salini         1.92291    0.04548  42.283  &lt; 2e-16 ***
## expprev      -22.44482    3.42240  -6.558 1.44e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7777 on 471 degrees of freedom
## Multiple R-squared:  0.7935, Adjusted R-squared:  0.7926 
## F-statistic: 904.8 on 2 and 471 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="gráficas-básicas-de-diagnóstico" class="section level3" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> Gráficas básicas de diagnóstico</h3>
<p>Con la función <code>plot</code> se pueden generar gráficos de interés para la diagnosis del modelo:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="modelos-lineales.html#cb604-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>( <span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb604-2"><a href="modelos-lineales.html#cb604-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="modelos-lineales.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span></code></pre></div>
<p>Por defecto se muestran cuatro gráficos (ver <code>help(plot.lm)</code> para más detalles). El primero (residuos frente a predicciones) permite detectar falta de
linealidad o heterocedasticidad (o el efecto de un factor omitido: mala
especificación del modelo), lo ideal sería no observar ningún patrón.</p>
<p>El segundo gráfico (gráfico QQ), permite diagnosticar la normalidad, los puntos del deberían estar cerca de la diagonal.</p>
<p>El tercer gráfico de dispersión-nivel permite detectar heterocedasticidad y ayudar a seleccionar una transformación para corregirla (más adelante, en la sección <em>Alternativas</em>, se tratará este tema), la pendiente de los datos debería ser nula.</p>
<p>El último gráfico permite detectar valores atípicos o influyentes. Representa los residuos estandarizados en función del valor de influencia (a priori) o leverage (<span class="math inline">\(hii\)</span> que depende de los valores de las variables explicativas, debería ser <span class="math inline">\(&lt; 2(p+1)/2\)</span>) y señala las observaciones atípicas (residuos fuera de [-2,2]) e influyentes a posteriori (estadístico de Cook &gt;0.5 y &gt;1).</p>
<p>Si las conclusiones obtenidas dependen en gran medida de una
observación (normalmente atípica), esta se denomina influyente (a
posteriori) y debe ser examinada con cuidado por el experimentador.
Para recalcular el modelo sin una de las observaciones puede ser útil la función update:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="modelos-lineales.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which.max(cooks.distance(modelo))</span></span>
<span id="cb606-2"><a href="modelos-lineales.html#cb606-2" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo, <span class="at">data =</span> empleados[<span class="sc">-</span><span class="dv">29</span>, ])</span></code></pre></div>
<p>Si hay datos atípicos o influyentes, puede ser recomendable emplear regresión lineal robusta, por ejemplo mediante la función <code>rlm</code> del paquete <code>MASS</code>.</p>
<p>En el ejemplo anterior, se observa claramente heterogeneidad de varianzas y falta de normalidad. Aparentemente no hay observaciones influyentes (a posteriori) aunque si algún dato atípico.</p>
</div>
<div id="gráficos-parciales-de-residuos" class="section level3" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> Gráficos parciales de residuos</h3>
<p>En regresión lineal múltiple, en lugar de generar gráficos de dispersión simple
(p.e. gráficos de dispersión matriciales) para detectar problemas (falta de
linealidad, …) y analizar los efectos de las variables explicativas,
se pueden generar gráficos parciales de residuos, por ejemplo con el comando:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="modelos-lineales.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">termplot</span>(modelo, <span class="at">partial.resid =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Aunque puede ser preferible emplear las funciones <code>crPlots</code> ó <code>avPlots</code> del paquete <code>car</code>:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="modelos-lineales.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb608-2"><a href="modelos-lineales.html#cb608-2" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(modelo)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="modelos-lineales.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co"># avPlots(modelo)</span></span></code></pre></div>
<p>Estas funciones permitirían además detectar puntos atípicos o influyentes
(mediante los argumentos <code>id.method</code> e <code>id.n</code>).</p>
</div>
<div id="estadísticos" class="section level3" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> Estadísticos</h3>
<p>Para obtener medidas de diagnosis o resúmenes numéricos de interés se pueden emplear
las siguientes funciones:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th>Función</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rstandard</td>
<td>residuos estandarizados</td>
</tr>
<tr class="even">
<td>rstudent</td>
<td>residuos estudentizados (eliminados)</td>
</tr>
<tr class="odd">
<td>cooks.distance</td>
<td>valores del estadístico de Cook</td>
</tr>
<tr class="even">
<td>influence</td>
<td>valores de influencia, cambios en coeficientes y varianza residual al eliminar cada dato.</td>
</tr>
</tbody>
</table>
<p>Ejecutar <code>help(influence.measures)</code> para ver un listado de medidas de diagnóstico adicionales.</p>
<p>Hay muchas herramientas adicionales disponibles en otros paquetes.
Por ejemplo, para la detección de multicolinealidad, se puede emplear la función
<code>vif</code> del paquete <code>car</code> para calcular los factores de inflación de varianza para
las variables del modelo:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="modelos-lineales.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(car)</span></span>
<span id="cb610-2"><a href="modelos-lineales.html#cb610-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(modelo)</span></code></pre></div>
<pre><code>##   salini  expprev 
## 1.002041 1.002041</code></pre>
<p>Valores grandes, por ejemplo &gt; 10, indican la posible presencia de multicolinealidad.</p>
<p><strong>Nota</strong>: Las tolerancias (proporciones de variabilidad no explicada por las demás covariables) se pueden calcular con <code>1/vif(modelo)</code>.</p>
</div>
<div id="contrastes-1" class="section level3" number="8.7.4">
<h3><span class="header-section-number">8.7.4</span> Contrastes</h3>
<div id="normalidad-1" class="section level4" number="8.7.4.1">
<h4><span class="header-section-number">8.7.4.1</span> Normalidad</h4>
<p>Para realizar el contraste de normalidad de Shapiro-Wilk se puede emplear:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="modelos-lineales.html#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(modelo))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(modelo)
## W = 0.85533, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="modelos-lineales.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(modelo))</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="homocedasticidad" class="section level4" number="8.7.4.2">
<h4><span class="header-section-number">8.7.4.2</span> Homocedasticidad</h4>
<p>La librería <code>lmtest</code> proporciona herramientas adicionales para la diagnosis de modelos lineales, por ejemplo el test de Breusch-Pagan para heterocedasticidad:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="modelos-lineales.html#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb615-2"><a href="modelos-lineales.html#cb615-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo, <span class="at">studentize =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Breusch-Pagan test
## 
## data:  modelo
## BP = 290.37, df = 2, p-value &lt; 2.2e-16</code></pre>
<p>Si el p-valor es grande aceptaríamos que hay igualdad de varianzas.</p>
</div>
<div id="autocorrelación" class="section level4" number="8.7.4.3">
<h4><span class="header-section-number">8.7.4.3</span> Autocorrelación</h4>
<p>Contraste de Durbin-Watson para detectar si hay correlación serial entre los errores:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="modelos-lineales.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(modelo, <span class="at">alternative=</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  modelo
## DW = 1.8331, p-value = 0.06702
## alternative hypothesis: true autocorrelation is not 0</code></pre>
<p>Si el p-valor es pequeño rechazaríamos la hipótesis de independencia.</p>
</div>
</div>
</div>
<div id="métodos-de-regularización" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Métodos de regularización</h2>
<p>[[Pasar a selección de variables explicativas?]]</p>
<p>Estos métodos emplean también un modelo lineal:
<span class="math display">\[Y=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{p}X_{p}+\varepsilon\]</span></p>
<p>En lugar de ajustarlo por mínimos cuadrados (estándar), minimizando:
<span class="math display">\[ RSS = \sum\limits_{i=1}^{n}\left(  y_{i} - \beta_0 - \beta_1 x_{1i} - \cdots - \beta_p x_{pi} \right)^{2}\]</span></p>
<p>Se imponen restricciones adicionales a los parámetros que los
“retraen” (shrink) hacia cero:</p>
<ul>
<li><p>Produce una reducción en la varianza de predicción (a
costa del sesgo).</p></li>
<li><p>En principio se consideran todas las variables explicativas.</p></li>
</ul>
<p><strong>Ridge regression</strong></p>
<ul>
<li>Penalización cuadrática: <span class="math inline">\(RSS+\lambda\sum_{j=1}^{p}\beta_{j}^{2}\)</span>.</li>
</ul>
<p><strong>Lasso</strong></p>
<ul>
<li><p>Penalización en valor absoluto: <span class="math inline">\(RSS+\lambda\sum_{j=1}^{p}|\beta_{j}|\)</span>.</p></li>
<li><p>Normalmente asigna peso nulo a algunas variables
(selección de variables).</p></li>
</ul>
<p>El parámetro de penalización se selecciona por <strong>validación cruzada</strong>.</p>
<ul>
<li>Normalmente estandarizan las variables explicativas
(coeficientes en la misma escala).</li>
</ul>
<div id="datos" class="section level3" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> Datos</h3>
<p>El fichero <em>hatco.RData</em> contiene observaciones de clientes de la compañía de
distribución industrial (Compañía Hair, Anderson y Tatham).
Las variables se pueden clasificar en tres grupos:</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="modelos-lineales.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;datos/hatco.RData&#39;</span>)</span>
<span id="cb619-2"><a href="modelos-lineales.html#cb619-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">attr</span>(hatco, <span class="st">&quot;variable.labels&quot;</span>))</span></code></pre></div>
<pre><code>##          attr(hatco, &quot;variable.labels&quot;)
## empresa                         Empresa
## tamano             Tamaño de la empresa
## adquisic      Estructura de adquisición
## tindustr              Tipo de industria
## tsitcomp    Tipo de situación de compra
## velocida           Velocidad de entrega
## precio                 Nivel de precios
## flexprec        Flexibilidad de precios
## imgfabri          Imagen del fabricante
## servconj              Servicio conjunto
## imgfvent     Imagen de fuerza de ventas
## calidadp            Calidad de producto
## fidelida   Porcentaje de compra a HATCO
## satisfac            Satisfacción global
## nfidelid        Nivel de compra a HATCO
## nsatisfa          Nivel de satisfacción</code></pre>
<p>Consideraremos como respuesta la variable <em>fidelida</em> y como variables explicativas
el resto de variables continuas menos <em>satisfac</em>.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="modelos-lineales.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code></pre></div>
<pre><code>## Warning: package &#39;glmnet&#39; was built under R version 4.1.1</code></pre>
<p>El paquete <code>glmnet</code> no emplea formulación de modelos, hay que establecer la respuesta
<code>y</code> y las variables explicativas <code>x</code> (se puede emplear la función <code>model.matrix()</code> para construir <code>x</code>,
la matriz de diseño, a partir de una fórmula).
En este caso, eliminamos también la última fila por tener datos faltantes:</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="modelos-lineales.html#cb623-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(hatco[<span class="sc">-</span><span class="dv">100</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb623-2"><a href="modelos-lineales.html#cb623-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> hatco<span class="sc">$</span>fidelida[<span class="sc">-</span><span class="dv">100</span>]</span></code></pre></div>
</div>
<div id="ridge-regression" class="section level3" number="8.8.2">
<h3><span class="header-section-number">8.8.2</span> Ridge Regression</h3>
<p>Ajustamos un modelo de regresión ridge con la función <code>glmnet</code> con <code>alpha=0</code> (ridge penalty).</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="modelos-lineales.html#cb624-1" aria-hidden="true" tabindex="-1"></a>fit.ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb624-2"><a href="modelos-lineales.html#cb624-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.ridge, <span class="at">xvar =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Para seleccionar el parámetro de penalización por validación cruzada se puede emplear
la función <code>cv.glmnet</code>.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="modelos-lineales.html#cb625-1" aria-hidden="true" tabindex="-1"></a>cv.ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb625-2"><a href="modelos-lineales.html#cb625-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.ridge)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>En este caso el parámetro sería:</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="modelos-lineales.html#cb626-1" aria-hidden="true" tabindex="-1"></a>cv.ridge<span class="sc">$</span>lambda<span class="fl">.1</span>se</span></code></pre></div>
<pre><code>## [1] 3.017977</code></pre>
<p>y el modelo resultante contiene todas las variables explicativas:</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="modelos-lineales.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(cv.ridge)</span></code></pre></div>
<pre><code>## 8 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                    s1
## (Intercept) 3.3722695
## velocida    1.5991955
## precio      0.7512946
## flexprec    2.3818230
## imgfabri    0.2960322
## servconj    3.9127056
## imgfvent    1.1068114
## calidadp    0.1052501</code></pre>
</div>
<div id="lasso" class="section level3" number="8.8.3">
<h3><span class="header-section-number">8.8.3</span> Lasso</h3>
<p>Ajustamos un modelo lasso también con la función <code>glmnet</code> (con la opción por defecto <code>alpha=1</code>, lasso penalty).</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="modelos-lineales.html#cb630-1" aria-hidden="true" tabindex="-1"></a>fit.lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y)</span>
<span id="cb630-2"><a href="modelos-lineales.html#cb630-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.lasso, <span class="at">xvar =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Seleccionamos el parámetro de penalización por validación cruzada.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="modelos-lineales.html#cb631-1" aria-hidden="true" tabindex="-1"></a>cv.lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x,y)</span>
<span id="cb631-2"><a href="modelos-lineales.html#cb631-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.lasso)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>En este caso el modelo resultante solo contiene 4 variables explicativas:</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="modelos-lineales.html#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(cv.lasso)</span></code></pre></div>
<pre><code>## 8 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                    s1
## (Intercept) 4.4757712
## velocida    0.1020531
## precio      .        
## flexprec    2.7202485
## imgfabri    .        
## servconj    6.4044378
## imgfvent    0.4651076
## calidadp    .</code></pre>
</div>
</div>
<div id="alternativas" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> Alternativas</h2>
<div id="transformación-modelos-linealizables" class="section level3" number="8.9.1">
<h3><span class="header-section-number">8.9.1</span> Transformación (modelos linealizables)</h3>
<p>Cuando no se satisfacen los supuestos básicos se puede intentar
transformar los datos para corregir la falta de
linealidad, la heterocedasticidad y/o la falta de normalidad
(normalmente estas últimas “suelen ocurrir en la misma escala”).
Por ejemplo, la función <code>boxcox</code> del paquete <code>MASS</code> permite seleccionar la transformación de Box-Cox
más adecuada:
<span class="math display">\[Y^{(\lambda)} =
\begin{cases}
\dfrac{Y^\lambda - 1}{\lambda} &amp; \text{si } \lambda \neq 0 \\
\ln{(Y)} &amp; \text{si } \lambda = 0
\end{cases}\]</span></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="modelos-lineales.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(MASS)</span></span>
<span id="cb634-2"><a href="modelos-lineales.html#cb634-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(modelo)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>En este caso una transformación logarítmica parece adecuada.</p>
<p>En ocasiones para obtener una relación lineal (o heterocedasticidad) también es
necesario transformar las covariables además de la respuesta. Algunas de
las relaciones fácilmente linealizables se muestran a continuación:</p>
<table>
<thead>
<tr class="header">
<th>modelo</th>
<th>ecuación</th>
<th>covariable</th>
<th>respuesta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>logarítmico</td>
<td><span class="math inline">\(y = a + b\text{ }log(x)\)</span></td>
<td><span class="math inline">\(log(x)\)</span></td>
<td>_</td>
</tr>
<tr class="even">
<td>inverso</td>
<td><span class="math inline">\(y = a + b/x\)</span></td>
<td><span class="math inline">\(1/x\)</span></td>
<td>_</td>
</tr>
<tr class="odd">
<td>potencial</td>
<td><span class="math inline">\(y = ax^b\)</span></td>
<td><span class="math inline">\(log(x)\)</span></td>
<td><span class="math inline">\(log(y)\)</span></td>
</tr>
<tr class="even">
<td>exponencial</td>
<td><span class="math inline">\(y = ae^{bx}\)</span></td>
<td>_</td>
<td><span class="math inline">\(log(y)\)</span></td>
</tr>
<tr class="odd">
<td>curva-S</td>
<td><span class="math inline">\(y = ae^{b/x}\)</span></td>
<td><span class="math inline">\(1/x\)</span></td>
<td><span class="math inline">\(log(y)\)</span></td>
</tr>
</tbody>
</table>
<div id="ejemplo-1" class="section level4" number="8.9.1.1">
<h4><span class="header-section-number">8.9.1.1</span> Ejemplo:</h4>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="modelos-lineales.html#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salario <span class="sc">~</span> salini, <span class="at">data =</span> empleados, <span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>)</span>
<span id="cb635-2"><a href="modelos-lineales.html#cb635-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-3"><a href="modelos-lineales.html#cb635-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste lineal</span></span>
<span id="cb635-4"><a href="modelos-lineales.html#cb635-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(salario <span class="sc">~</span> salini, <span class="at">data =</span> empleados)) </span>
<span id="cb635-5"><a href="modelos-lineales.html#cb635-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-6"><a href="modelos-lineales.html#cb635-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo exponencial</span></span>
<span id="cb635-7"><a href="modelos-lineales.html#cb635-7" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(salario) <span class="sc">~</span> salini, <span class="at">data =</span> empleados)</span>
<span id="cb635-8"><a href="modelos-lineales.html#cb635-8" aria-hidden="true" tabindex="-1"></a>parest <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo1)</span>
<span id="cb635-9"><a href="modelos-lineales.html#cb635-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(parest[<span class="dv">1</span>] <span class="sc">+</span> parest[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb635-10"><a href="modelos-lineales.html#cb635-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-11"><a href="modelos-lineales.html#cb635-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo logarítmico</span></span>
<span id="cb635-12"><a href="modelos-lineales.html#cb635-12" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(salario) <span class="sc">~</span> <span class="fu">log</span>(salini), <span class="at">data =</span> empleados)</span>
<span id="cb635-13"><a href="modelos-lineales.html#cb635-13" aria-hidden="true" tabindex="-1"></a>parest <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo2)</span>
<span id="cb635-14"><a href="modelos-lineales.html#cb635-14" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(parest[<span class="dv">1</span>]) <span class="sc">*</span> x<span class="sc">^</span>parest[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb635-15"><a href="modelos-lineales.html#cb635-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-16"><a href="modelos-lineales.html#cb635-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Lineal&quot;</span>,<span class="st">&quot;Exponencial&quot;</span>,<span class="st">&quot;Logarítmico&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Con estos datos de ejemplo, el principal problema es la falta de homogeneidad de varianzas (y de normalidad) y se corrige sustancialmente con el segundo modelo:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="modelos-lineales.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(salario) <span class="sc">~</span> <span class="fu">log</span>(salini), <span class="at">data =</span> empleados)</span>
<span id="cb636-2"><a href="modelos-lineales.html#cb636-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(modelo2)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="ajuste-polinómico" class="section level3" number="8.9.2">
<h3><span class="header-section-number">8.9.2</span> Ajuste polinómico</h3>
<p>En este apartado utilizaremos como ejemplo el conjunto de datos <code>Prestige</code> de la librería <code>car</code>. Al tratar de explicar <code>prestige</code> (puntuación de ocupaciones obtenidas a partir de una encuesta ) a partir de <code>income</code> (media de ingresos en la ocupación), un ajuste cuadrático puede parecer razonable:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="modelos-lineales.html#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(car)</span></span>
<span id="cb637-2"><a href="modelos-lineales.html#cb637-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prestige <span class="sc">~</span> income, <span class="at">data =</span> Prestige, <span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>)</span>
<span id="cb637-3"><a href="modelos-lineales.html#cb637-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste lineal</span></span>
<span id="cb637-4"><a href="modelos-lineales.html#cb637-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(prestige <span class="sc">~</span> income, <span class="at">data =</span> Prestige)) </span>
<span id="cb637-5"><a href="modelos-lineales.html#cb637-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste cuadrático</span></span>
<span id="cb637-6"><a href="modelos-lineales.html#cb637-6" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(prestige <span class="sc">~</span> income <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> Prestige)</span>
<span id="cb637-7"><a href="modelos-lineales.html#cb637-7" aria-hidden="true" tabindex="-1"></a>parest <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)</span>
<span id="cb637-8"><a href="modelos-lineales.html#cb637-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(parest[<span class="dv">1</span>] <span class="sc">+</span> parest[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> parest[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb637-9"><a href="modelos-lineales.html#cb637-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-10"><a href="modelos-lineales.html#cb637-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Lineal&quot;</span>,<span class="st">&quot;Cuadrático&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Alternativamente se podría emplear la función <code>poly</code>:</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="modelos-lineales.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prestige <span class="sc">~</span> income, <span class="at">data =</span> Prestige, <span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>)</span>
<span id="cb638-2"><a href="modelos-lineales.html#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste cúbico</span></span>
<span id="cb638-3"><a href="modelos-lineales.html#cb638-3" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(prestige <span class="sc">~</span> <span class="fu">poly</span>(income, <span class="dv">3</span>), <span class="at">data =</span> Prestige)</span>
<span id="cb638-4"><a href="modelos-lineales.html#cb638-4" aria-hidden="true" tabindex="-1"></a>valores <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">26000</span>, <span class="at">len =</span> <span class="dv">100</span>)</span>
<span id="cb638-5"><a href="modelos-lineales.html#cb638-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">income =</span> valores))</span>
<span id="cb638-6"><a href="modelos-lineales.html#cb638-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(valores, pred, <span class="at">lty =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="ajuste-polinómico-local-robusto" class="section level3" number="8.9.3">
<h3><span class="header-section-number">8.9.3</span> Ajuste polinómico local (robusto)</h3>
<p>Si no se logra un buen ajuste empleando los modelos anteriores se puede pensar en
utilizar métodos no paramétricos (p.e. regresión aditiva no paramétrica). Por ejemplo,
en<code>R</code> es habitual emplear la función <code>loess</code> (sobre todo en gráficos):</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="modelos-lineales.html#cb639-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prestige <span class="sc">~</span> income, Prestige, <span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>)</span>
<span id="cb639-2"><a href="modelos-lineales.html#cb639-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">loess</span>(prestige <span class="sc">~</span> income, Prestige, <span class="at">span =</span> <span class="fl">0.75</span>)</span>
<span id="cb639-3"><a href="modelos-lineales.html#cb639-3" aria-hidden="true" tabindex="-1"></a>valores <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">25000</span>, <span class="dv">100</span>)</span>
<span id="cb639-4"><a href="modelos-lineales.html#cb639-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">income =</span> valores))</span>
<span id="cb639-5"><a href="modelos-lineales.html#cb639-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(valores, pred)</span></code></pre></div>
<p><img src="08-ModelosLineales_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Este tipo de modelos los trataremos con detalle más adelante…</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelado-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelos-lineales-generalizados.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/intror/edit/master/08-ModelosLineales.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Intro_Analisis_Datos_R.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
